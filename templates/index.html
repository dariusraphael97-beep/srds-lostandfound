{% extends "base.html" %}
{% block title %}SRDS Lost & Found â€” Home{% endblock %}

{% block content %}

<!-- HERO -->
<section class="hero" aria-labelledby="hero-heading">
  <div class="hero-bg"></div>
  <div class="particles"></div>
  <div class="hero-grid-overlay" aria-hidden="true"></div>

  <!-- Watermark crest -->
  <img src="{{ url_for('static', filename='img/srds-crest.svg') }}"
       class="hero-crest-watermark" alt="" aria-hidden="true" />

  <div class="hero-content container">
    <div>
      <div class="hero-eyebrow reveal">
        <span class="dot" aria-hidden="true"></span>
        Saddle River Day School â€” Official Lost &amp; Found
      </div>

      <h1 id="hero-heading" class="reveal reveal-delay-1">
        <span style="display:block; font-style:normal;">Find What's</span>
        <span style="display:block; font-style:italic; background:linear-gradient(90deg,#fff 0%,rgba(74,127,212,0.9) 50%,#fff 100%); background-size:200% auto; -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; animation:shimmer 4s linear infinite;">Lost.</span>
        <span style="display:block; font-style:normal;">Return What's <em>Found.</em></span>
      </h1>

      <p class="hero-desc reveal reveal-delay-2">
        Our school community's official lost-and-found portal.
        Whether you've found something in the halls or you're missing a belonging,
        this is the place to start â€” fast, verified, and built for Rebels.
      </p>

      <div class="hero-actions reveal reveal-delay-3">
        <a href="{{ url_for('items') }}" class="btn btn-primary">ğŸ” Browse Lost Items</a>
        <a href="{{ url_for('report') }}" class="btn btn-outline">ğŸ“‹ Report Found Item</a>
      </div>

      <div class="reveal reveal-delay-4" style="display:flex; gap:20px; margin-top:32px; flex-wrap:wrap;">
        <span style="display:flex; align-items:center; gap:7px; font-size:0.82rem; color:var(--white-40);"><span style="color:var(--success);">âœ“</span> Free for all SRDS students &amp; staff</span>
        <span style="display:flex; align-items:center; gap:7px; font-size:0.82rem; color:var(--white-40);"><span style="color:var(--success);">âœ“</span> Every item reviewed by staff</span>
        <span style="display:flex; align-items:center; gap:7px; font-size:0.82rem; color:var(--white-40);"><span style="color:var(--success);">âœ“</span> Works on any device</span>
      </div>
    </div>

    <!-- Stats + quick actions panel -->
    <div class="hero-panel reveal reveal-delay-2" aria-label="Site statistics and quick actions">
      <div style="display:flex; align-items:center; gap:10px; margin-bottom:18px;">
        <img src="{{ url_for('static', filename='img/srds-crest.svg') }}" width="32" height="32" alt="" style="opacity:0.6;" aria-hidden="true" />
        <span style="font-size:0.72rem; font-weight:700; text-transform:uppercase; letter-spacing:0.15em; color:var(--white-40);">Live Statistics</span>
      </div>

      <div class="stat-grid">
        <div class="stat-box">
          <span class="stat-number" data-target="{{ total }}">0</span>
          <div class="stat-label">Items Listed</div>
        </div>
        <div class="stat-box">
          <span class="stat-number" data-target="{{ claimed }}">0</span>
          <div class="stat-label">Items Returned</div>
        </div>
      </div>
      <div class="stat-box" style="margin-top:12px; text-align:center;">
        <span class="stat-number" style="font-size:2rem;">24h</span>
        <div class="stat-label">Avg. Response Time</div>
      </div>

      <div style="border-top:1px solid var(--white-10); padding-top:16px; margin-top:16px; display:flex; flex-direction:column; gap:8px;">
        <a href="{{ url_for('items') }}"
           style="display:flex; align-items:center; gap:10px; padding:12px 16px; background:var(--white-05); border:1px solid var(--white-10); border-radius:var(--radius-sm); color:var(--white-70); font-size:0.88rem; font-weight:500; transition:all var(--transition);"
           onmouseover="this.style.borderColor='rgba(74,127,212,0.4)'; this.style.background='rgba(74,127,212,0.08)'"
           onmouseout="this.style.borderColor='var(--white-10)'; this.style.background='var(--white-05)'">
          <span>ğŸ”</span> Search all found items <span style="margin-left:auto;">â†’</span>
        </a>
        <a href="{{ url_for('report') }}"
           style="display:flex; align-items:center; gap:10px; padding:12px 16px; background:var(--white-05); border:1px solid var(--white-10); border-radius:var(--radius-sm); color:var(--white-70); font-size:0.88rem; font-weight:500; transition:all var(--transition);"
           onmouseover="this.style.borderColor='rgba(74,127,212,0.4)'; this.style.background='rgba(74,127,212,0.08)'"
           onmouseout="this.style.borderColor='var(--white-10)'; this.style.background='var(--white-05)'">
          <span>ğŸ“‹</span> Report a found item <span style="margin-left:auto;">â†’</span>
        </a>
        <div style="display:flex; align-items:center; gap:10px; padding:12px 16px; background:var(--white-05); border:1px solid var(--white-10); border-radius:var(--radius-sm); color:var(--white-40); font-size:0.8rem;">
          <span>âŒ¨ï¸</span> Press <kbd style="padding:2px 8px; border:1px solid var(--white-20); border-radius:4px; font-size:0.72rem; font-family:monospace;">Ctrl K</kbd> to search instantly
        </div>
      </div>
    </div>
  </div>
</section>

<!-- SCHOOL MOTTO BAND -->
<div class="motto-band">
  <strong>"Everyone Counts.</strong> Love of Learning. Intellectual Risk-Taking." &nbsp;Â·&nbsp; <strong>Go Rebels!</strong>
</div>

<!-- RECENT ITEMS -->
{% if recent %}
<section class="section" aria-labelledby="recent-heading">
  <div class="container">
    <div class="section-heading reveal">
      <p class="eyebrow">Just Added</p>
      <h2 id="recent-heading">Recently Found Items</h2>
      <p style="margin-top:12px; max-width:500px; margin-left:auto; margin-right:auto; font-size:0.95rem; color:var(--white-70);">
        These items were recently turned in to the office. Recognize something? Submit a claim and we'll be in touch.
      </p>
      <div class="section-divider" aria-hidden="true"></div>
    </div>

    <div class="items-grid">
      {% for item in recent %}
      <article class="card reveal reveal-delay-{{ (loop.index0 % 3) + 1 }}" role="listitem">
        <div class="card-img-wrap">
          {% if item.photo %}
            <img class="card-img" src="{{ url_for('static', filename='uploads/' + item.photo) }}" alt="Photo of {{ item.name }}" loading="lazy" />
          {% elif item.photo_url %}
            <img class="card-img" src="{{ item.photo_url }}" alt="Photo of {{ item.name }}" loading="lazy" />
          {% else %}
            <div class="card-img-placeholder">{{ item.emoji }}</div>
          {% endif %}
          <div class="card-img-overlay" aria-hidden="true"></div>
          <!-- Days since badge -->
          <div style="position:absolute; top:10px; right:10px;">
            <span class="days-badge fresh" data-found="{{ item.date_found }}">ğŸ• loadingâ€¦</span>
          </div>

        </div>
        <div class="card-body">
          <span class="card-category">{{ item.category }}</span>
          <a href="{{ url_for('item_detail', item_id=item.id) }}" style="text-decoration:none;"><h3 class="card-title" style="transition:color var(--transition);" onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color=''">{{ item.name }}</h3></a>
          <div class="card-meta">
            <span>ğŸ“ {{ item.location }}</span>
            <span>ğŸ“… {{ item.date_found }}</span>
          </div>
{% if item.item_detail %}
          <div style="display:flex; flex-wrap:wrap; gap:5px; margin-bottom:12px;">
            {% for part in item.item_detail.split(' Â· ') %}
            <span style="font-size:0.68rem; background:var(--white-05); border:1px solid var(--white-10); color:var(--white-70); padding:3px 9px; border-radius:100px;">{{ part }}</span>
            {% endfor %}
          </div>
          {% endif %}
          <p style="font-size:0.84rem; color:var(--white-40); margin-bottom:16px; line-height:1.5;">
            {{ item.description[:80] }}{% if item.description|length > 80 %}â€¦{% endif %}
          </p>
          <div class="card-actions">
            <a href="{{ url_for('claim', item_id=item.id) }}" class="btn btn-primary btn-sm">Claim This</a>
            <button class="bookmark-btn" data-id="{{ item.id }}" aria-label="Bookmark {{ item.name }}">ğŸ·ï¸</button>
          </div>
        </div>
      </article>
      {% endfor %}
    </div>

    <div class="reveal" style="text-align:center; margin-top:48px;">
      <a href="{{ url_for('items') }}" class="btn btn-glass">View All {{ total }} Items â†’</a>
    </div>
  </div>
</section>
{% endif %}

<!-- HOW IT WORKS -->
<section class="section" style="background:rgba(13,27,62,0.5); border-top:1px solid var(--white-10); border-bottom:1px solid var(--white-10);" aria-labelledby="how-heading">
  <div class="container">
    <div class="section-heading reveal">
      <p class="eyebrow">Simple Process</p>
      <h2 id="how-heading">How It Works</h2>
      <p style="margin-top:12px; max-width:480px; margin-left:auto; margin-right:auto; font-size:0.95rem; color:var(--white-70);">Getting reunited with your belongings is simple.</p>
      <div class="section-divider" aria-hidden="true"></div>
    </div>
    <div class="steps-grid">
      <div class="step-card reveal reveal-delay-1">
        <div class="step-number">1</div>
        <h3>Found Something?</h3>
        <p>Fill out our quick form and upload a photo. Takes under 2 minutes â€” you're helping a classmate out.</p>
      </div>
      <div class="step-card reveal reveal-delay-2">
        <div class="step-number">2</div>
        <h3>Staff Reviews It</h3>
        <p>A member of the SRDS team reviews every submission before it goes public, keeping things accurate and safe.</p>
      </div>
      <div class="step-card reveal reveal-delay-3">
        <div class="step-number">3</div>
        <h3>Search &amp; Browse</h3>
        <p>Search by keyword, filter by category, or scroll through items. Bookmark ones you're keeping an eye on.</p>
      </div>
      <div class="step-card reveal reveal-delay-4">
        <div class="step-number">4</div>
        <h3>Claim &amp; Collect</h3>
        <p>Spot your item? Submit a claim with your student ID. Staff will verify and arrange pickup â€” no fuss.</p>
      </div>
    </div>
  </div>
</section>

<!-- BROWSE BY CATEGORY -->
<section class="section" aria-labelledby="categories-heading">
  <div class="container">
    <div class="section-heading reveal">
      <p class="eyebrow">Browse by Category</p>
      <h2 id="categories-heading">What Are You Looking For?</h2>
      <div class="section-divider" aria-hidden="true"></div>
    </div>
    <div style="display:grid; grid-template-columns:repeat(auto-fill, minmax(155px, 1fr)); gap:14px;">
      {% for cat, emoji in [('Bags & Backpacks','ğŸ’'),('Electronics','ğŸ“±'),('Clothing & Apparel','ğŸ‘•'),('Books & Stationery','ğŸ“š'),('Sports Equipment','âš½'),('Jewelry & Accessories','ğŸ’'),('Keys','ğŸ”‘'),('Water Bottles','ğŸ’§'),('Other','ğŸ“¦')] %}
      <a href="{{ url_for('items', category=cat) }}"
         class="reveal reveal-delay-{{ loop.index if loop.index <= 4 else 4 }}"
         style="display:flex; flex-direction:column; align-items:center; gap:10px; padding:24px 14px;
                background:var(--white-05); border:1px solid var(--white-10); border-radius:var(--radius);
                transition:all 0.3s ease; text-align:center;"
         onmouseover="this.style.borderColor='rgba(74,127,212,0.5)'; this.style.background='rgba(74,127,212,0.08)'; this.style.transform='translateY(-5px)'"
         onmouseout="this.style.borderColor='var(--white-10)'; this.style.background='var(--white-05)'; this.style.transform=''">
        <span style="font-size:2rem;" aria-hidden="true">{{ emoji }}</span>
        <span style="font-size:0.76rem; font-weight:600; color:var(--white-70); line-height:1.3;">{{ cat }}</span>
      </a>
      {% endfor %}
    </div>
  </div>
</section>

<!-- CTA -->
<section class="section-sm">
  <div class="container">
    <div class="cta-box reveal">
      <img src="{{ url_for('static', filename='img/srds-crest.svg') }}" alt="" width="60" height="60"
           style="opacity:0.2; margin:0 auto 20px; display:block;" aria-hidden="true" />
      <p style="font-size:0.72rem; font-weight:700; letter-spacing:0.2em; text-transform:uppercase; color:var(--accent); margin-bottom:14px;">Found Something at SRDS?</p>
      <h2 style="color:var(--white); margin-bottom:14px;">Help a Fellow Rebel Get Their Stuff Back</h2>
      <p style="color:var(--white-70); margin-bottom:32px; max-width:480px; margin-left:auto; margin-right:auto; line-height:1.8;">
        It takes less than 2 minutes. Fill in the details, snap a photo, submit â€” and our staff will handle the rest.
        Small act, big impact.
      </p>
      <div style="display:flex; gap:14px; justify-content:center; flex-wrap:wrap;">
        <a href="{{ url_for('report') }}" class="btn btn-primary">ğŸ“‹ Report a Found Item</a>
        <a href="{{ url_for('items') }}" class="btn btn-outline">ğŸ” Browse All Items</a>
      </div>
    </div>
  </div>
</section>

{% endblock %}

{% block scripts %}
<script>
  // Days since found badges
  document.querySelectorAll('.days-badge[data-found]').forEach(badge => {
    const found = new Date(badge.dataset.found);
    const today = new Date();
    const days  = Math.floor((today - found) / (1000 * 60 * 60 * 24));
    badge.classList.remove('fresh', 'old');
    if (days === 0)       { badge.textContent = 'ğŸ• Today';         badge.classList.add('fresh'); }
    else if (days <= 3)   { badge.textContent = `ğŸ• ${days}d ago`;  badge.classList.add('fresh'); }
    else if (days <= 14)  { badge.textContent = `ğŸ• ${days}d ago`;  }
    else                  { badge.textContent = `ğŸ• ${days}d ago`;  badge.classList.add('old'); }
  });
</script>
{% endblock %}
